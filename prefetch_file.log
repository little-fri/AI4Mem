uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 4096) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
Allocating 4096 MB Unified Memory...
Initializing data on CPU...
Starting 20s workload on GPU...
Events will be spread over time...
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 4096) -> invalid argument
1. Reading data.csv...
2. Incremental Encoding...
   Current Vocab: Pages=17198, Kernels=2
3. Saved processed data to data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Adapting model in memory: {'num_pages': 16252, 'num_kernels': 2, 'num_events': 3} -> {'num_pages': 17198, 'num_kernels': 2, 'num_events': 3}
Predicting (Vocab: 17198)...
Inference Done. Saved to predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae419000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae43b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae63d000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae902000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2aeaa8000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae419000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae43b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae63d000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae902000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2aeaa8000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae419000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae43b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae63d000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae902000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2aeaa8000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
Loading Data...
Target Vocab: {'num_pages': 17198, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
   Expanding page_embed.weight: 16252 -> 17198
   Expanding fc.weight: 16252 -> 17198
   Expanding fc.bias: 16252 -> 17198
Training 2 epochs...
Model saved.
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae419000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae43b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae63d000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae902000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2aeaa8000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae419000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae43b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae63d000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae902000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2aeaa8000, 4096) -> invalid argument
1. Reading data.csv...
2. Incremental Encoding...
   Current Vocab: Pages=17198, Kernels=2
3. Saved processed data to data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae419000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae43b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae63d000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae902000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2aeaa8000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7efcb6000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae419000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae43b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae63d000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae902000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2aeaa8000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Predicting (Vocab: 17198)...
Inference Done. Saved to predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
Workload finished.
>>> Flushing data... <<<
>>> Done. <<<
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
Loading Data...
Target Vocab: {'num_pages': 17198, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
Training 2 epochs...
Model saved.
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
1. Reading data.csv...
2. Incremental Encoding...
   Current Vocab: Pages=17198, Kernels=2
3. Saved processed data to data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Predicting (Vocab: 17198)...
Inference Done. Saved to predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
1. Reading data.csv...
2. Incremental Encoding...
   Current Vocab: Pages=17198, Kernels=2
3. Saved processed data to data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
Loading Data...
Target Vocab: {'num_pages': 17198, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
Training 2 epochs...
Model saved.
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
Loading Data...
Target Vocab: {'num_pages': 17198, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
Training 1 epochs...
Model saved.
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Predicting (Vocab: 17198)...
Inference Done. Saved to predictions.csv
启动测试程序: ./test
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
data.csv 暂无 UVM 事件，跳过本轮
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result_20251216_152818_20251216_152823.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result_20251216_152818_20251216_152823_20251216_152828_20251216_152833.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
已拷贝 uvm_monitor_result.csv -> data.csv
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Final] 执行最后一次同步训练...
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
Allocating 4096 MB Unified Memory...
Initializing data on CPU...
Starting 20s workload on GPU...
Events will be spread over time...
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
1. Reading data.csv...
2. Incremental Encoding...
   Current Vocab: Pages=18177, Kernels=2
3. Saved processed data to data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Adapting model in memory: {'num_pages': 17198, 'num_kernels': 2, 'num_events': 3} -> {'num_pages': 18177, 'num_kernels': 2, 'num_events': 3}
Predicting (Vocab: 18177)...
Inference Done. Saved to predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
Loading Data...
Target Vocab: {'num_pages': 18177, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
   Expanding page_embed.weight: 17198 -> 18177
   Expanding fc.weight: 17198 -> 18177
   Expanding fc.bias: 17198 -> 18177
Training 2 epochs...
Model saved.
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
1. Reading data.csv...
2. Incremental Encoding...
   Current Vocab: Pages=18177, Kernels=2
3. Saved processed data to data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd2ae000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Predicting (Vocab: 18177)...
Inference Done. Saved to predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
Workload finished.
>>> Flushing data... <<<
>>> Done. <<<
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
Loading Data...
Target Vocab: {'num_pages': 18177, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
Training 2 epochs...
Model saved.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
1. Reading data.csv...
2. Incremental Encoding...
   Current Vocab: Pages=18177, Kernels=2
3. Saved processed data to data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Predicting (Vocab: 18177)...
Inference Done. Saved to predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
1. Reading data.csv...
2. Incremental Encoding...
   Current Vocab: Pages=18177, Kernels=2
3. Saved processed data to data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
Loading Data...
Target Vocab: {'num_pages': 18177, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
Training 2 epochs...
Model saved.
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
Loading Data...
Target Vocab: {'num_pages': 18177, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
Training 1 epochs...
Model saved.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f912e000000, 8192) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Predicting (Vocab: 18177)...
Inference Done. Saved to predictions.csv
启动测试程序: ./test
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
data.csv 暂无 UVM 事件，跳过本轮
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result_20251216_152908_20251216_152913_20251216_152918_20251216_152923.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
已拷贝 uvm_monitor_result.csv -> data.csv
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Final] 执行最后一次同步训练...
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
Allocating 4096 MB Unified Memory...
Initializing data on CPU...
Starting 20s workload on GPU...
Events will be spread over time...
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
[1. 读取 data.csv]
【2. 编码数据】
   当前 Vocab: Pages=20022, Kernels=2
【3. 保存预处理数据到 data_cache/processed_data.pkl】
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Predicting (Vocab: 20022)...
Inference Done. Saved to predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
【train：加载数据】
Target Vocab: {'num_pages': 20022, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
Training 2 epochs...
Model saved.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
[1. 读取 data.csv]
【2. 编码数据】
   当前 Vocab: Pages=21010, Kernels=2
【3. 保存预处理数据到 data_cache/processed_data.pkl】
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Adapting model in memory: {'num_pages': 20022, 'num_kernels': 2, 'num_events': 3} -> {'num_pages': 21010, 'num_kernels': 2, 'num_events': 3}
Predicting (Vocab: 21010)...
Inference Done. Saved to predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a22b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8aa28000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a22b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8aa28000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a22b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8aa28000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
【train：加载数据】
Target Vocab: {'num_pages': 21010, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
 【train：拓展 page_embed.weight: 20022 -> 21010】
【train  扩展 fc.weight: 20022 -> 21010】
【train  扩展 fc.bias: 20022 -> 21010】
Training 2 epochs...
Model saved.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a22b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8aa28000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a22b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8aa28000, 4096) -> invalid argument
Workload finished.
[1. 读取 data.csv]
【2. 编码数据】
   当前 Vocab: Pages=21010, Kernels=2
【3. 保存预处理数据到 data_cache/processed_data.pkl】
>>> Flushing data... <<<
>>> Done. <<<
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a22b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8aa28000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f3946000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a22b000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8aa28000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Predicting (Vocab: 21010)...
Inference Done. Saved to predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
[1. 读取 data.csv]
【2. 编码数据】
   当前 Vocab: Pages=21010, Kernels=2
【3. 保存预处理数据到 data_cache/processed_data.pkl】
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
【train：加载数据】
Target Vocab: {'num_pages': 21010, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
Training 2 epochs...
Model saved.
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
【train：加载数据】
Target Vocab: {'num_pages': 21010, 'num_kernels': 2, 'num_events': 3}
Loading and Expanding old model weights...
Training 1 epochs...
Model saved.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
Predicting (Vocab: 21010)...
Inference Done. Saved to predictions.csv
启动测试程序: ./test
已拷贝 uvm_monitor_result_20251216_153434_20251216_153439_20251216_153444_20251216_153450.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
已拷贝 uvm_monitor_result.csv -> data.csv
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Final] 执行最后一次同步训练...
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
Allocating 4096 MB Unified Memory...
Initializing data on CPU...
Starting 20s workload on GPU...
Events will be spread over time...
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
[1. 读取 data.csv]
【2. 编码数据】
   当前 Vocab: Pages=21940, Kernels=2
【3. 保存预处理数据到 data_cache/processed_data.pkl】
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 适配模型内存: {'num_pages': 21010, 'num_kernels': 2, 'num_events': 3} -> {'num_pages': 21940, 'num_kernels': 2, 'num_events': 3}
[infer] 预测中 (Vocab: 21940)...
[infer] 推理完成，保存到predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train] 目标 Vocab: {'num_pages': 21940, 'num_kernels': 2, 'num_events': 3}
[train] 加载并扩展旧模型权重...
 [train]: 拓展 page_embed.weight: 21010 -> 21940
[train]:  扩展 fc.weight: 21010 -> 21940
[train]:  扩展 fc.bias: 21010 -> 21940
[train] 训练 2 epochs...
[train] 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
[1. 读取 data.csv]
【2. 编码数据】
   当前 Vocab: Pages=21940, Kernels=2
【3. 保存预处理数据到 data_cache/processed_data.pkl】
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f8a8a000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 预测中 (Vocab: 21940)...
[infer] 推理完成，保存到predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
Workload finished.
>>> Flushing data... <<<
>>> Done. <<<
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train] 目标 Vocab: {'num_pages': 21940, 'num_kernels': 2, 'num_events': 3}
[train] 加载并扩展旧模型权重...
[train] 训练 2 epochs...
[train] 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
[1. 读取 data.csv]
【2. 编码数据】
   当前 Vocab: Pages=21940, Kernels=2
【3. 保存预处理数据到 data_cache/processed_data.pkl】
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 预测中 (Vocab: 21940)...
[infer] 推理完成，保存到predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
[1. 读取 data.csv]
【2. 编码数据】
   当前 Vocab: Pages=21940, Kernels=2
【3. 保存预处理数据到 data_cache/processed_data.pkl】
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train] 目标 Vocab: {'num_pages': 21940, 'num_kernels': 2, 'num_events': 3}
[train] 加载并扩展旧模型权重...
[train] 训练 2 epochs...
[train] 模型已保存.
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train] 目标 Vocab: {'num_pages': 21940, 'num_kernels': 2, 'num_events': 3}
[train] 加载并扩展旧模型权重...
[train] 训练 1 epochs...
[train] 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 预测中 (Vocab: 21940)...
[infer] 推理完成，保存到predictions.csv
启动测试程序: ./test
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
data.csv 暂无 UVM 事件，跳过本轮
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result_20251216_153920_20251216_153925.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result_20251216_153920_20251216_153925_20251216_153930_20251216_153935.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
已拷贝 uvm_monitor_result.csv -> data.csv
  [Sync] Running preprocess: /usr/bin/python3 /root/AI4Memv3/preprocess.py --fit
  [Final] 执行最后一次同步训练...
  [Sync] Running infer: /usr/bin/python3 /root/AI4Memv3/infer.py
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
[test]：分配 4096 MB UVM...
[test]：初始化数据在 CPU...
[test]:程序开始运行
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]:2. 编码数据
[preprocess]:   当前 Vocab: Pages=22961, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 适配模型内存: {'num_pages': 21940, 'num_kernels': 2, 'num_events': 3} -> {'num_pages': 22961, 'num_kernels': 2, 'num_events': 3}
[infer] 预测中 (Vocab: 22961)...
[infer] 推理完成，保存到predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train] 目标 Vocab: {'num_pages': 22961, 'num_kernels': 2, 'num_events': 3}
[train] 加载并扩展旧模型权重...
 [train]: 拓展 page_embed.weight: 21940 -> 22961
[train]:  扩展 fc.weight: 21940 -> 22961
[train]:  扩展 fc.bias: 21940 -> 22961
[train] 训练 2 epochs...
[train] 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]:2. 编码数据
[preprocess]:   当前 Vocab: Pages=22961, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f073e000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 预测中 (Vocab: 22961)...
[infer] 推理完成，保存到predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
[test]:程序运行结束.
>>> Flushing data... <<<
>>> Done. <<<
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train] 目标 Vocab: {'num_pages': 22961, 'num_kernels': 2, 'num_events': 3}
[train] 加载并扩展旧模型权重...
[train] 训练 2 epochs...
[train] 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]:2. 编码数据
[preprocess]:   当前 Vocab: Pages=22961, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 预测中 (Vocab: 22961)...
[infer] 推理完成，保存到predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]:2. 编码数据
[preprocess]:   当前 Vocab: Pages=22961, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train] 目标 Vocab: {'num_pages': 22961, 'num_kernels': 2, 'num_events': 3}
[train] 加载并扩展旧模型权重...
[train] 训练 2 epochs...
[train] 模型已保存.
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train] 目标 Vocab: {'num_pages': 22961, 'num_kernels': 2, 'num_events': 3}
[train] 加载并扩展旧模型权重...
[train] 训练 1 epochs...
[train] 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 预测中 (Vocab: 22961)...
[infer] 推理完成，保存到predictions.csv
启动测试程序: ./test
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
data.csv 暂无 UVM 事件，跳过本轮
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Async] 启动后台训练 (Epoch=2)...
已拷贝 uvm_monitor_result_20251216_154223_20251216_154228_20251216_154233_20251216_154238.csv -> data.csv
>>> 检测到新数据，开始 AI 流水线 <<<
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
已拷贝 uvm_monitor_result.csv -> data.csv
  [Final] 执行最后一次同步训练...
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
[test]：分配 4096 MB UVM...
[test]：初始化数据在 CPU...
[test]:程序开始运行
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=23948, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 适配模型内存: {'num_pages': 22961, 'num_kernels': 2, 'num_events': 3} -> {'num_pages': 23948, 'num_kernels': 2, 'num_events': 3}
[infer] 预测中 (Vocab: 23948)...
[infer] 推理完成，保存到predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e680000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84ec80000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626001000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626246000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626400000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626433000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626d24000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626ece000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd62703f000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd6270ad000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e680000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84ec80000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626001000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626246000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626400000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626433000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626d24000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626ece000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd62703f000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd6270ad000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e680000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84ec80000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626001000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626246000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626400000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626433000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626d24000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626ece000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd62703f000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd6270ad000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 23948, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 拓展 page_embed.weight: 22961 -> 23948
[train]: 扩展 fc.weight: 22961 -> 23948
[train]: 扩展 fc.bias: 22961 -> 23948
[train]: 训练 2 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e680000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84ec80000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626001000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626246000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626400000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626433000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626d24000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626ece000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd62703f000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd6270ad000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e680000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84ec80000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626001000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626246000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626400000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626433000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626d24000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626ece000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd62703f000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd6270ad000, 4096) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=23951, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e680000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84ec80000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626001000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626246000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626400000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626433000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626d24000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626ece000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd62703f000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd6270ad000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84e680000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fa84ec80000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626001000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626246000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626400000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626433000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626d24000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626ece000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd62703f000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd6270ad000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 适配模型内存: {'num_pages': 23948, 'num_kernels': 2, 'num_events': 3} -> {'num_pages': 23951, 'num_kernels': 2, 'num_events': 3}
[infer] 预测中 (Vocab: 23951)...
[infer] 推理完成，保存到predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
[test]:程序运行结束.
>>> Flushing data... <<<
>>> Done. <<<
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 23951, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 拓展 page_embed.weight: 23948 -> 23951
[train]: 扩展 fc.weight: 23948 -> 23951
[train]: 扩展 fc.bias: 23948 -> 23951
[train]: 训练 2 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=23951, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 预测中 (Vocab: 23951)...
[infer] 推理完成，保存到predictions.csv
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=23951, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 23951, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 2 epochs...
[train]: 模型已保存.
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 23951, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 1 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:107: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(MODEL_FILE)
[infer] 预测中 (Vocab: 23951)...
[infer] 推理完成，保存到predictions.csv
启动测试程序: ./test
data.csv 暂无 UVM 事件，跳过本轮
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
  [Final] 执行最后一次同步训练...
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
[test]：分配 4096 MB UVM...
[test]：初始化数据在 CPU...
[test]:程序开始运行
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=24960, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7fd626000000, 4096) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] No valid predictions
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 24960, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 拓展 page_embed.weight: 23951 -> 24960
[train]: 扩展 fc.weight: 23951 -> 24960
[train]: 扩展 fc.bias: 23951 -> 24960
[train]: 训练 2 epochs...
[train]: 模型已保存.
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=24960, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
[test]:程序运行结束.
>>> Flushing data... <<<
>>> Done. <<<
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 24960, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 2 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=24960, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=24960, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 24960, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 2 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 24960, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 1 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
启动测试程序: ./test
data.csv 暂无 UVM 事件，跳过本轮
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
  [Final] 执行最后一次同步训练...
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
[test]：分配 4096 MB UVM...
[test]：初始化数据在 CPU...
[test]: 程序开始运行
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=25985, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f9d07fff000, 16384) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] No valid predictions
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 25985, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 拓展 page_embed.weight: 24960 -> 25985
[train]: 扩展 fc.weight: 24960 -> 25985
[train]: 扩展 fc.bias: 24960 -> 25985
[train]: 训练 2 epochs...
[train]: 模型已保存.
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=25985, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 3 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 12288) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 12288) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 12288) -> invalid argument
[test]: 程序运行结束.
>>> Flushing data... <<<
>>> Done. <<<
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 25985, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 2 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 12288) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 12288) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=25985, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 12288) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 12288) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=25985, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 25985, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 2 epochs...
[train]: 模型已保存.
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 25985, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 1 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
启动测试程序: ./test
data.csv 暂无 UVM 事件，跳过本轮
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
  [Final] 执行最后一次同步训练...
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
[test]：分配 4096 MB UVM...
[test]：初始化数据在 CPU...
[test]: 程序开始运行
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=26984, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7ff32dfff000, 16384) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] No valid predictions
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 26984, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 拓展 page_embed.weight: 25985 -> 26984
[train]: 扩展 fc.weight: 25985 -> 26984
[train]: 扩展 fc.bias: 25985 -> 26984
[train]: 训练 2 epochs...
[train]: 模型已保存.
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=26984, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 3 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 12288) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 12288) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 12288) -> invalid argument
[test]: 程序运行结束.
>>> Flushing data... <<<
>>> Done. <<<
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 26984, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 2 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 12288) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 12288) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=26984, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 12288) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 12288) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=26984, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 26984, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 2 epochs...
[train]: 模型已保存.
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 26984, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 1 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
启动测试程序: ./test
data.csv 暂无 UVM 事件，跳过本轮
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
  [Final] 执行最后一次同步训练...
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
>>> [Force Init] Attempting to wake up GPU... <<<
>>> UVM Counters Configured Successfully. <<<
[test]：分配 4096 MB UVM...
[test]：初始化数据在 CPU...
[test]: 程序开始运行
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=27904, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f743bfff000, 16384) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] No valid predictions
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 27904, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 拓展 page_embed.weight: 26984 -> 27904
[train]: 扩展 fc.weight: 26984 -> 27904
[train]: 扩展 fc.bias: 26984 -> 27904
[train]: 训练 2 epochs...
[train]: 模型已保存.
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=27904, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
[test]: 程序运行结束.
>>> Flushing data... <<<
>>> Done. <<<
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 27904, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 2 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=27904, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
[preprocess]: 1.读取 data.csv]
[preprocess]: 2. 编码数据
[preprocess]: 当前 Vocab: Pages=27904, Kernels=2
[preprocess]: 3. 保存预处理数据到 data_cache/processed_data.pkl
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 27904, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 2 epochs...
[train]: 模型已保存.
/root/AI4Memv3/train_model.py:103: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  old_state = torch.load(MODEL_FILE)
[train]：加载数据
[train]: 目标 Vocab: {'num_pages': 27904, 'num_kernels': 2, 'num_events': 3}
[train]: 加载并扩展旧模型权重...
[train]: 训练 1 epochs...
[train]: 模型已保存.
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
uvm_prefetcher: cudaMemPrefetchAsync(0x7f4b9dfff000, 16384) -> invalid argument
/root/AI4Memv3/infer.py:97: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(MODEL_FILE)
[Infer] Generated 6 prefetch entries
启动测试程序: ./test
data.csv 暂无 UVM 事件，跳过本轮
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
  [Async] 启动后台训练 (Epoch=2)...
测试程序退出，做最后一次处理后结束
  [Final] 执行最后一次同步训练...
